zabbix_export:
  version: '6.0'
  date: '2023-05-18T18:51:46Z'
  groups:
    -
      uuid: 7df96b18c230490a9a0a9e2307226338
      name: Templates
  templates:
    -
      uuid: 6d0e026af302451ab0f6ad53d4d562f6
      template: Backups-Msp360
      name: Backups-Msp360
      groups:
        -
          name: Templates
      items:
        -
          uuid: 18baaa6307114c2f81d1c1f3995f6a98
          name: GetAllMSP360MonitorData
          type: EXTERNAL
          key: zabbix-msp360-api.py
          delay: 1h
          history: 7d
          trends: '0'
          value_type: TEXT
      discovery_rules:
        -
          uuid: c80bf6c7cd77470788c846d2d3a726ae
          name: GetAllBackupJobs
          type: DEPENDENT
          key: 'msp360-backup-[{#PLANID}]'
          delay: '0'
          item_prototypes:
            -
              uuid: a7ea2f5bd50741568149fc4ec7ee1bfe
              name: 'MSP360 Backup status for [{#COMPANYNAME}] [{#COMPUTERNAME}] [{#PLANNAME}]'
              type: DEPENDENT
              key: 'msp360-status-backup-[{#PLANID}]'
              delay: '0'
              valuemap:
                name: BackupStatus
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.PlanId==''{#PLANID}'')]'
                -
                  type: JSONPATH
                  parameters:
                    - $..Status
                -
                  type: STR_REPLACE
                  parameters:
                    - '['
                    - ''
                -
                  type: STR_REPLACE
                  parameters:
                    - ']'
                    - ''
              master_item:
                key: zabbix-msp360-api.py
              trigger_prototypes:
                -
                  uuid: 95abedd5d4f34640a9094968b1b7895e
                  expression: 'last(/Backups-Msp360/msp360-status-backup-[{#PLANID}])<>0'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Backups-Msp360/msp360-status-backup-[{#PLANID}])=0'
                  name: 'MSP360 Backup problem detected for [{#COMPANYNAME}] [{#COMPUTERNAME}] [{#PLANNAME}]'
                  priority: HIGH
                  description: 'A status different than 0 was detected in the backup/restore/consistency plan.'
                  manual_close: 'YES'
          master_item:
            key: zabbix-msp360-api.py
          lld_macro_paths:
            -
              lld_macro: '{#BUILDVERSION}'
              path: $.BuildVersion
            -
              lld_macro: '{#COMPANYNAME}'
              path: $.CompanyName
            -
              lld_macro: '{#COMPUTERNAME}'
              path: $.ComputerName
            -
              lld_macro: '{#DATACOPIED}'
              path: $.DataCopied
            -
              lld_macro: '{#DATATOBACKUP}'
              path: $.DataToBackup
            -
              lld_macro: '{#DETAILEDREPORTLINK}'
              path: $.DetailedReportLink
            -
              lld_macro: '{#DURATION}'
              path: $.Duration
            -
              lld_macro: '{#ERRORMESSAGE}'
              path: $.ErrorMessage
            -
              lld_macro: '{#FILESCOPIED}'
              path: $.FilesCopied
            -
              lld_macro: '{#FILESFAILED}'
              path: $.FilesFailed
            -
              lld_macro: '{#FILESSCANNED}'
              path: $.FilesScanned
            -
              lld_macro: '{#FILESTOBACKUP}'
              path: $.FilesToBackup
            -
              lld_macro: '{#LASTSTART}'
              path: $.LastStart
            -
              lld_macro: '{#NEXTSTART}'
              path: $.NextStart
            -
              lld_macro: '{#PLANID}'
              path: $.PlanId
            -
              lld_macro: '{#PLANNAME}'
              path: $.PlanName
            -
              lld_macro: '{#PLANTYPE}'
              path: $.PlanType
            -
              lld_macro: '{#STATUS}'
              path: $.Status
            -
              lld_macro: '{#STORAGETYPE}'
              path: $.StorageType
            -
              lld_macro: '{#TOTALDATA}'
              path: $.TotalData
            -
              lld_macro: '{#USERID}'
              path: $.UserID
            -
              lld_macro: '{#USERNAME}'
              path: $.UserName
      valuemaps:
        -
          uuid: bf9090ba124a4f1e99648a107c734465
          name: BackupStatus
          mappings:
            -
              value: '0'
              newvalue: Success
            -
              value: '1'
              newvalue: Overdue
            -
              value: '2'
              newvalue: Error
            -
              value: '3'
              newvalue: Running
            -
              value: '4'
              newvalue: Unknown
            -
              value: '5'
              newvalue: Interrupted
            -
              value: '6'
              newvalue: UnexpectedlyClosed
            -
              value: '7'
              newvalue: Warning
        -
          uuid: 5e88e0827e3549fca9dabd334e570462
          name: PlanType
          mappings:
            -
              value: '0'
              newvalue: NA/Unknown
            -
              value: '1'
              newvalue: Backup
            -
              value: '2'
              newvalue: Restore
            -
              value: '3'
              newvalue: Backup-Files
            -
              value: '4'
              newvalue: Restore-Files
            -
              value: '5'
              newvalue: Backup-VM
            -
              value: '6'
              newvalue: Restore-VM
            -
              value: '7'
              newvalue: Backup-SQL
            -
              value: '8'
              newvalue: Restore-SQL
            -
              value: '9'
              newvalue: Backup-Exchange
            -
              value: '10'
              newvalue: Restore-Exchange
            -
              value: '11'
              newvalue: Backup-BMSS
            -
              value: '12'
              newvalue: Restore-BMSS
            -
              value: '13'
              newvalue: ConsistencyCheck
            -
              value: '14'
              newvalue: Backup-EC2
            -
              value: '15'
              newvalue: Restore-EC2
            -
              value: '16'
              newvalue: Backup-HyperV
            -
              value: '17'
              newvalue: Restore-HyperV
